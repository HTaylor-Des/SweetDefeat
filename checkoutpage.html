<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Jekyll v3.8.6">
  <title>Sweet Defeat: Eat em' or Beat em'</title>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <!-- Custom styles for this template -->
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      object-fit: contain;
    }

    .image-container {
      background-color: #feedb3;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
</head>

<body>
<header>
  <div class="collapse bg-info" id="navbarHeader">
    <div class="container">
      <div class="row">
        <div class="col-sm-8 col-md-7 py-4">
          <h4 class="text-white">About</h4>
          <p class="text-white">We are dedicated to making the game a little bit easier. We all know those players who seem to have all the legendary gear, who you just can't beat. Well, we have what you need. Don't just play games, win them!</p>
        </div>
        <div class="col-sm-4 offset-md-1 py-4">
          <h4 class="text-white">Contact</h4>
          <ul class="list-unstyled">
            <li><a href="https://www.Instagram.com/heathertaylorsart" class="text-white">Follow on Instagram</a></li>
            <li><a href="https://www.Facebook.com/heather.taylor.7758" class="text-white">Like on Facebook</a></li>
            <li><a href="mailto: heanictay@gmail.com" class="text-white">Email me</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="navbar navbar-dark bg-info shadow-sm">
    <div class="container d-flex justify-content-between">
      <a href="bootstrapexample.html" class="navbar-brand d-flex align-items-center">
        <img src="sweetdefeatskull.png" width="50" height="50" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true" class="mr-2" viewBox="0 0 24 24" focusable="false"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></img>
        <strong>Sweet Defeat</strong>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
</header>

<main role="main">
  <div class="album py-5 bg-light">
    <div class="container">

      <div class="cart">
        <!-- List items in cart here with a table -->

        <table class="table table-striped">
            <tr>
            <div id="emptyDiv">
                

      </div>

      <button id="checkout" class="btn btn-primary">Checkout</button>
    </div>
  </div>
</main>


</body>

<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://js.stripe.com/v3"></script>

<script>
    (function() {

        // $("#emptyDiv").html("<td>" + items.getJSONArray(0));

            


        var stripe = Stripe('pk_test_WUwtJ1mYd7091YAilAafV5qB00dXfD2AlP');

        //The checkout button above is being found

        var checkoutButton = document.getElementById('checkout');

        var items = readCart();

        console.log(items);

        //$.each(items, function (index, value) {
        //    $('#emptyDiv').html('<tr> <td>' + value.sku + "</td></tr>");
        //});

        let table = "<table>";

        $.each(items, function (index, value) {
        table += "<tr><td>" + value.name + "</td></tr>";
        });
        table += "</table>";
        $('#emptyDiv').html(table);

        checkoutButton.addEventListener('click', function () {
            stripe.redirectToCheckout({
                items: [{sku: checkoutButton.data("sku"), quantity: 1}],
                successUrl: 'https://github.com/HTaylor-Des/SweetDefeat/success',
                cancelUrl: 'https://github.com/HTaylor-Des/SweetDefeat/canceled',

                //can't create successful URLs due to not having website on a server

            })
                .then(function (result) {
                    if (result.error) {
                        // If `redirectToCheckout` fails due to a browser or network
                        // error, display the localized error message to your customer.
                        var displayError = document.getElementById('error-message');
                        displayError.textContent = result.error.message;
                    }
                });
        });
    })();



    // Cart functions

    const cartCookieName = 'cart';

    function readCart() {
        var json_str = getCookie('cart');
        console.log(json_str);
        return JSON.parse(json_str);
    }

    console.log(readCart)


    // Cookie functions

    function getCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }

</script>

</html>
